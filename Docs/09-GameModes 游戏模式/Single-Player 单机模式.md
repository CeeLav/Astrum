# ğŸ¯ å•æœºæ¨¡å¼è®¾è®¡æ–‡æ¡£

**ç‰ˆæœ¬**: v0.1.0  
**çŠ¶æ€**: ğŸš§ å¼€å‘ä¸­  
**æœ€åæ›´æ–°**: 2025-10-10

---

## ğŸ“‹ ç›®å½•

1. [æ¦‚è¿°](#æ¦‚è¿°)
2. [è®¾è®¡ç›®æ ‡](#è®¾è®¡ç›®æ ‡)
3. [æ ¸å¿ƒæ¶æ„](#æ ¸å¿ƒæ¶æ„)
4. [å¯åŠ¨æµç¨‹](#å¯åŠ¨æµç¨‹)
5. [å¸§å¾ªç¯æœºåˆ¶](#å¸§å¾ªç¯æœºåˆ¶)
6. [AIç³»ç»Ÿ](#aiç³»ç»Ÿ)
7. [å­˜æ¡£ç³»ç»Ÿ](#å­˜æ¡£ç³»ç»Ÿ)
8. [å…³å¡ç³»ç»Ÿ](#å…³å¡ç³»ç»Ÿ)
9. [ä¸è”æœºæ¨¡å¼çš„åŒºåˆ«](#ä¸è”æœºæ¨¡å¼çš„åŒºåˆ«)

---

## æ¦‚è¿°

å•æœºæ¨¡å¼æ˜¯ Astrum æ¸¸æˆçš„æœ¬åœ°æ¸¸ç©æ–¹å¼ï¼Œç©å®¶æ— éœ€è¿æ¥æœåŠ¡å™¨å³å¯ä½“éªŒå®Œæ•´çš„æ¸¸æˆå†…å®¹ã€‚è¯¥æ¨¡å¼é‡‡ç”¨**æœ¬åœ°å¸§åŒæ­¥**æ¶æ„ï¼Œä¸è”æœºæ¨¡å¼å…±äº«ç›¸åŒçš„é€»è¾‘å±‚ä»£ç ï¼Œç¡®ä¿æ¸¸æˆä½“éªŒçš„ä¸€è‡´æ€§ã€‚

### æ ¸å¿ƒç‰¹æ€§

- **æ— ç½‘ç»œä¾èµ–** - å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œ0å»¶è¿Ÿ
- **ç¡®å®šæ€§é€»è¾‘** - ä½¿ç”¨ TrueSync ç¡®ä¿é€»è¾‘ç¡®å®šæ€§
- **AIå¯¹æ‰‹** - æ™ºèƒ½AIæ›¿ä»£çœŸå®ç©å®¶
- **å­˜æ¡£æ”¯æŒ** - æœ¬åœ°å­˜æ¡£ç³»ç»Ÿ
- **å¯æš‚åœ** - æ”¯æŒæ¸¸æˆæš‚åœå’Œç»§ç»­
- **è°ƒè¯•å‹å¥½** - ä¾¿äºå¼€å‘å’Œæµ‹è¯•

---

## è®¾è®¡ç›®æ ‡

### å¼€å‘é˜¶æ®µç›®æ ‡

1. **å¿«é€ŸéªŒè¯ç©æ³•** ğŸ®
   - ä¸ä¾èµ–æœåŠ¡å™¨å’Œç½‘ç»œï¼Œå¿«é€Ÿè¿­ä»£æ ¸å¿ƒç©æ³•
   - æä¾›å®Œæ•´çš„æˆ˜æ–—ã€æŠ€èƒ½ã€ç‰©ç†ç³»ç»Ÿæµ‹è¯•ç¯å¢ƒ

2. **é€»è¾‘å±‚æµ‹è¯•** ğŸ§ª
   - ä½œä¸ºé€»è¾‘å±‚çš„ä¸»è¦æµ‹è¯•ç¯å¢ƒ
   - éªŒè¯ ECC æ¶æ„ã€å¸§åŒæ­¥ã€ç¢°æ’æ£€æµ‹ç­‰æ ¸å¿ƒç³»ç»Ÿ

3. **å†…å®¹å¼€å‘åŸºç¡€** ğŸ“¦
   - å…³å¡è®¾è®¡å’Œæµ‹è¯•
   - AIè¡Œä¸ºè°ƒè¯•
   - æ•°å€¼å¹³è¡¡

### ç©å®¶ä½“éªŒç›®æ ‡

1. **å®Œæ•´æ¸¸æˆä½“éªŒ** âœ…
   - æä¾›ä¸è”æœºæ¨¡å¼ç›¸åŒè´¨é‡çš„æˆ˜æ–—ä½“éªŒ
   - æ”¯æŒæ‰€æœ‰è§’è‰²ã€æŠ€èƒ½ã€è£…å¤‡ç³»ç»Ÿ

2. **æµç•…æ€§èƒ½** âš¡
   - 60 FPS ç¨³å®šå¸§ç‡
   - å³æ—¶å“åº”ï¼Œæ— å»¶è¿Ÿ

3. **è¿›åº¦ä¿å­˜** ğŸ’¾
   - å…³å¡è¿›åº¦è‡ªåŠ¨ä¿å­˜
   - è§’è‰²æˆé•¿æ•°æ®æŒä¹…åŒ–

---

## æ ¸å¿ƒæ¶æ„

### ç³»ç»Ÿç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         GameApplication (å…¥å£)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GameConfig   â”‚       â”‚GamePlayManagerâ”‚
â”‚  (é…ç½®ç®¡ç†)   â”‚       â”‚  (æ¸¸æˆç®¡ç†)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â†“                       â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     Room     â”‚â”€â”€â”€â”€â”€â”€â”€â†’â”‚    World    â”‚
            â”‚  (æ¸¸æˆæˆ¿é—´)   â”‚        â”‚ (ECSä¸–ç•Œ)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚     Stage    â”‚
            â”‚  (è¡¨ç°èˆå°)   â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç±»è¯´æ˜

#### 1. GameConfig
**è·¯å¾„**: `AstrumClient/Core/GameConfig.cs`

**èŒè´£**:
- ç®¡ç†æ¸¸æˆæ¨¡å¼çŠ¶æ€ï¼ˆå•æœº/è”æœºï¼‰
- æ¸¸æˆéš¾åº¦è®¾ç½®
- å…¨å±€é…ç½®ç®¡ç†

**å…³é”®æ¥å£**:
```csharp
public bool IsSinglePlayerMode { get; }
public void SetSinglePlayerMode(bool enabled);
public void SetDifficulty(GameDifficulty difficulty);
```

#### 2. GamePlayManager
**è·¯å¾„**: `AstrumClient/Managers/GamePlayManager.cs`

**èŒè´£**:
- æ¸¸æˆç”Ÿå‘½å‘¨æœŸç®¡ç†
- Room å’Œ Stage çš„åˆ›å»ºå’Œé”€æ¯
- å•æœº/è”æœºæ¨¡å¼çš„ç»Ÿä¸€å…¥å£

**å…³é”®æ¥å£**:
```csharp
public void StartSinglePlayerGame(string gameSceneName);
public Stage MainStage { get; }
public Room MainRoom { get; }
```

#### 3. GameLauncher
**è·¯å¾„**: `AstrumClient/Core/GameLauncher.cs`

**èŒè´£**:
- å•æœºæ¸¸æˆçš„å¯åŠ¨é€»è¾‘
- Roomã€Worldã€Stage çš„åˆå§‹åŒ–
- ç©å®¶è§’è‰²çš„åˆ›å»º

**å…³é”®æ¥å£**:
```csharp
public void StartSinglePlayerGame(string gameSceneName);
```

#### 4. Room (é€»è¾‘å±‚)
**è·¯å¾„**: `LogicCore/Core/Room.cs`

**èŒè´£**:
- æ¸¸æˆé€»è¾‘çš„å®¹å™¨
- å¸§åŒæ­¥ç®¡ç†
- ç©å®¶å’Œå®ä½“çš„ç®¡ç†

**å…³é”®å±æ€§**:
```csharp
public World MainWorld { get; set; }
public int RoomId { get; }
public string RoomName { get; }
```

#### 5. World (é€»è¾‘å±‚)
**è·¯å¾„**: `LogicCore/Core/World.cs`

**èŒè´£**:
- ECS ç³»ç»Ÿçš„å®¹å™¨
- å®ä½“çš„åˆ›å»ºå’Œç®¡ç†
- ç³»ç»Ÿçš„æ‰§è¡Œ

#### 6. Stage (è¡¨ç°å±‚)
**è·¯å¾„**: `AstrumView/Core/Stage.cs`

**èŒè´£**:
- Unity åœºæ™¯ç®¡ç†
- å®ä½“è§†å›¾çš„åˆ›å»ºå’ŒåŒæ­¥
- è¡¨ç°å±‚çš„ç”Ÿå‘½å‘¨æœŸ

---

## å¯åŠ¨æµç¨‹

### å®Œæ•´æµç¨‹å›¾

```
ç©å®¶ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"
        â†“
[1] GameConfig.SetSinglePlayerMode(true)
        â†“
[2] GamePlayManager.StartSinglePlayerGame("GameScene")
        â†“
[3] åˆ›å»º Room(id=1, "SinglePlayerRoom")
        â†“
[4] åˆ›å»º World å¹¶å…³è”åˆ° Room
        â†“
[5] Room.Initialize()
    - åˆå§‹åŒ– FrameSyncManagerï¼ˆæœ¬åœ°æ¨¡å¼ï¼‰
    - æ³¨å†Œç³»ç»Ÿï¼ˆç§»åŠ¨ã€æˆ˜æ–—ã€ç‰©ç†ç­‰ï¼‰
        â†“
[6] åˆ›å»º Stage("GameStage")
        â†“
[7] Stage.Initialize()
    - åˆå§‹åŒ– ViewWorld
    - æ³¨å†Œ ViewComponent ç±»å‹
        â†“
[8] åˆ‡æ¢åˆ°æ¸¸æˆåœºæ™¯ (LoadSceneAsync)
        â†“
[9] åœºæ™¯åŠ è½½å®Œæˆå›è°ƒ
    - Stage.SetActive(true)
    - Stage.OnEnter()
        â†“
[10] åˆ›å»ºç©å®¶å®ä½“
    - Room.AddPlayer(playerId)
    - åŠ è½½è§’è‰²é…ç½®
    - åˆ›å»º Entity + Components
    - åˆ›å»ºå¯¹åº”çš„ EntityView
        â†“
[11] å¼€å§‹æœ¬åœ°å¸§å¾ªç¯
    - Unity Update() é©±åŠ¨
    - æ¯å¸§æ”¶é›†æœ¬åœ°è¾“å…¥
    - æ‰§è¡Œå¸§é€»è¾‘
    - åŒæ­¥åˆ°è¡¨ç°å±‚
        â†“
æ¸¸æˆè¿è¡Œä¸­...
```

### è¯¦ç»†æ­¥éª¤

#### Step 1-2: æ¨¡å¼è®¾ç½®å’Œå¯åŠ¨å…¥å£
```csharp
// åœ¨ä¸»èœå•æˆ–æ¸¸æˆå¯åŠ¨æ—¶
GameConfig.Instance.SetSinglePlayerMode(true);
GamePlayManager.Instance.StartSinglePlayerGame("GameScene");
```

#### Step 3-5: åˆ›å»ºé€»è¾‘å±‚ç¯å¢ƒ
```csharp
// GamePlayManager.StartSinglePlayerGame()
var room = new Room(1, "SinglePlayerRoom");
var world = new World();
room.MainWorld = world;
room.Initialize(); // åˆå§‹åŒ–å¸§åŒæ­¥å’Œç³»ç»Ÿ
```

**å…³é”®ç‚¹**:
- Room ä¸è¿æ¥æœåŠ¡å™¨ï¼Œä½¿ç”¨æœ¬åœ°å¸§åŒæ­¥
- FrameSyncManager è®¾ç½®ä¸ºæœ¬åœ°æ¨¡å¼ï¼ˆæ— ç½‘ç»œå»¶è¿Ÿï¼‰
- æ‰€æœ‰è¾“å…¥ç›´æ¥åœ¨æœ¬åœ°å¤„ç†

#### Step 6-8: åˆ›å»ºè¡¨ç°å±‚å’Œåœºæ™¯åˆ‡æ¢
```csharp
Stage gameStage = new Stage("GameStage", "æ¸¸æˆåœºæ™¯");
gameStage.Initialize();
gameStage.SetRoom(room);

SceneManager.LoadSceneAsync("GameScene", () => {
    gameStage.SetActive(true);
    gameStage.OnEnter();
});
```

#### Step 9-10: åˆ›å»ºç©å®¶è§’è‰²
```csharp
// åœºæ™¯åŠ è½½å®Œæˆå
long playerId = room.AddPlayer();
Vector3 spawnPosition = new Vector3(-5f, 0.5f, 0f);

// ä»é…ç½®è¡¨åŠ è½½è§’è‰²æ•°æ®
var roleConfig = ConfigManager.Instance.GetRoleConfig(1001); // éª‘å£«
var entity = EntityFactory.CreateRoleEntity(world, roleConfig, spawnPosition);

// åˆ›å»ºå¯¹åº”çš„è¡¨ç°å±‚è§†å›¾
var entityView = gameStage.CreateEntityView(entity);
```

---

## å¸§å¾ªç¯æœºåˆ¶

### æœ¬åœ°å¸§åŒæ­¥æ¶æ„

å•æœºæ¨¡å¼ä½¿ç”¨**æœ¬åœ°ç¡®å®šæ€§å¸§åŒæ­¥**ï¼Œä¸è”æœºæ¨¡å¼çš„åŒºåˆ«åœ¨äºï¼š

| ç‰¹æ€§ | å•æœºæ¨¡å¼ | è”æœºæ¨¡å¼ |
|------|----------|----------|
| å¸§é©±åŠ¨ | Unity Update() | æœåŠ¡å™¨å¸§æ¨é€ |
| è¾“å…¥æº | æœ¬åœ° InputManager | ç½‘ç»œæ¥æ”¶ |
| å»¶è¿Ÿ | 0ms | ç½‘ç»œå»¶è¿Ÿ |
| ç¡®å®šæ€§ | æœ¬åœ°éªŒè¯ | æœåŠ¡å™¨æƒå¨ |

### å¸§å¾ªç¯æµç¨‹

```
Unity Update()
    â†“
[1] InputManager.Tick()
    - æ”¶é›†é”®ç›˜/é¼ æ ‡è¾“å…¥
    - è½¬æ¢ä¸º Input å¯¹è±¡
    â†“
[2] Room.Tick(input)
    - æ‰§è¡Œé€»è¾‘å¸§
    - æ›´æ–°æ‰€æœ‰ System
    â†“
[3] World.Tick()
    - MovementSystem.Tick()
    - CombatSystem.Tick()
    - PhysicsSystem.Tick()
    - SkillSystem.Tick()
    â†“
[4] Stage.Tick()
    - åŒæ­¥å®ä½“ä½ç½®/çŠ¶æ€
    - æ›´æ–°åŠ¨ç”»çŠ¶æ€
    - è§¦å‘ç‰¹æ•ˆ/éŸ³æ•ˆ
    â†“
[5] Render()
    - Unity æ¸²æŸ“
```

### ä»£ç ç¤ºä¾‹

```csharp
// ç®€åŒ–çš„å¸§å¾ªç¯ä¼ªä»£ç 
public class GameLoop : MonoBehaviour
{
    private Room _room;
    private Stage _stage;
    
    void Update()
    {
        if (_room == null) return;
        
        // 1. æ”¶é›†è¾“å…¥
        var input = InputManager.Instance.GetCurrentInput();
        
        // 2. æ‰§è¡Œé€»è¾‘å¸§
        _room.Tick(input);
        
        // 3. åŒæ­¥åˆ°è¡¨ç°å±‚
        _stage.Tick();
    }
}
```

---

## AIç³»ç»Ÿ

> **çŠ¶æ€**: ğŸ“ è§„åˆ’ä¸­

### è®¾è®¡ç›®æ ‡

- æä¾›æŒ‘æˆ˜æ€§çš„AIå¯¹æ‰‹
- æ¨¡æ‹ŸçœŸå®ç©å®¶çš„è¡Œä¸º
- æ”¯æŒå¤šç§éš¾åº¦çº§åˆ«

### AIæ¶æ„ï¼ˆè§„åˆ’ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        AIController            â”‚
â”‚  (AIæ§åˆ¶å™¨ï¼Œç±»ä¼¼ç©å®¶è¾“å…¥)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DecisionTree â”‚  â”‚  Behavior    â”‚
â”‚   (å†³ç­–æ ‘)    â”‚  â”‚   (è¡Œä¸ºæ ‘)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AIè¾“å…¥ç”Ÿæˆ

AIæ›¿ä»£çœŸå®ç©å®¶ï¼Œç”Ÿæˆ `Input` å¯¹è±¡ï¼š

```csharp
public class AIController
{
    public Input GenerateInput(Entity aiEntity, World world)
    {
        // 1. æ„ŸçŸ¥ç¯å¢ƒ
        var enemies = ScanNearbyEnemies(aiEntity, world);
        var obstacles = ScanObstacles(aiEntity, world);
        
        // 2. å†³ç­–
        var decision = DecideAction(enemies, obstacles);
        
        // 3. ç”Ÿæˆè¾“å…¥
        return new Input
        {
            PlayerId = aiEntity.UniqueId,
            MoveX = decision.MoveDirection.x,
            MoveY = decision.MoveDirection.y,
            Attack = decision.ShouldAttack,
            Skill = decision.SkillIndex
        };
    }
}
```

### éš¾åº¦çº§åˆ«

| éš¾åº¦ | ååº”æ—¶é—´ | å†³ç­–è´¨é‡ | æŠ€èƒ½ä½¿ç”¨ |
|------|----------|----------|----------|
| ç®€å• | æ…¢ (500ms) | åŸºç¡€ | å°‘ |
| æ™®é€š | ä¸­ç­‰ (300ms) | ä¸­ç­‰ | ä¸­ç­‰ |
| å›°éš¾ | å¿« (100ms) | é«˜çº§ | é¢‘ç¹ |
| åœ°ç‹± | å³æ—¶ (0ms) | å®Œç¾ | æœ€ä¼˜ |

---

## å­˜æ¡£ç³»ç»Ÿ

> **çŠ¶æ€**: ğŸ“ è§„åˆ’ä¸­

### å­˜æ¡£å†…å®¹

#### 1. æ¸¸æˆè¿›åº¦
- å·²å®Œæˆçš„å…³å¡
- å½“å‰å…³å¡è¿›åº¦
- è§£é”çš„å†…å®¹

#### 2. è§’è‰²æ•°æ®
- è§’è‰²ç­‰çº§å’Œç»éªŒ
- è§’è‰²å±æ€§
- å·²å­¦ä¹ çš„æŠ€èƒ½
- è£…å¤‡å’Œé“å…·

#### 3. é…ç½®è®¾ç½®
- æ¸¸æˆéš¾åº¦
- éŸ³é¢‘è®¾ç½®
- æ“ä½œè®¾ç½®

### å­˜æ¡£æ ¼å¼

**æ¨è**: JSON + MemoryPack äºŒè¿›åˆ¶

```csharp
[MemoryPackable]
public partial class SaveData
{
    public int Version { get; set; } = 1;
    public DateTime SaveTime { get; set; }
    
    // è¿›åº¦æ•°æ®
    public int CurrentLevel { get; set; }
    public List<int> CompletedLevels { get; set; }
    
    // è§’è‰²æ•°æ®
    public PlayerData PlayerData { get; set; }
    
    // é…ç½®
    public GameSettings Settings { get; set; }
}
```

### å­˜æ¡£ä½ç½®

```
Windows: %AppData%/Astrum/Saves/
Mac: ~/Library/Application Support/Astrum/Saves/
Linux: ~/.config/Astrum/Saves/
```

### è‡ªåŠ¨ä¿å­˜

- å…³å¡å®Œæˆæ—¶
- é‡è¦äº‹ä»¶åï¼ˆBosså‡»è´¥ã€å…³é”®é“å…·è·å¾—ï¼‰
- é€€å‡ºæ¸¸æˆæ—¶

---

## å…³å¡ç³»ç»Ÿ

> **çŠ¶æ€**: ğŸ“ è§„åˆ’ä¸­

### å…³å¡ç»“æ„

```
å…³å¡ (Level)
  â”œâ”€â”€ å…³å¡é…ç½® (LevelConfig)
  â”‚   â”œâ”€â”€ åœ°å›¾åœºæ™¯
  â”‚   â”œâ”€â”€ å‡ºç”Ÿç‚¹
  â”‚   â”œâ”€â”€ æ•Œäººæ³¢æ¬¡
  â”‚   â””â”€â”€ èƒœåˆ©æ¡ä»¶
  â”‚
  â”œâ”€â”€ æ•Œäººç”Ÿæˆå™¨ (EnemySpawner)
  â”‚   â”œâ”€â”€ æ³¢æ¬¡ç®¡ç†
  â”‚   â”œâ”€â”€ ç”Ÿæˆä½ç½®
  â”‚   â””â”€â”€ AIé…ç½®
  â”‚
  â””â”€â”€ å…³å¡äº‹ä»¶ (LevelEvents)
      â”œâ”€â”€ å¼€å§‹äº‹ä»¶
      â”œâ”€â”€ è¿›åº¦äº‹ä»¶
      â””â”€â”€ ç»“æŸäº‹ä»¶
```

### å…³å¡é…ç½®è¡¨

```csharp
// é…ç½®è¡¨å®šä¹‰
public class LevelConfig
{
    public int LevelId;
    public string LevelName;
    public string SceneName;
    public List<SpawnPoint> PlayerSpawnPoints;
    public List<EnemyWave> EnemyWaves;
    public VictoryCondition WinCondition;
    public int RewardExp;
    public List<int> RewardItems;
}
```

### å…³å¡æµç¨‹

```
[å¼€å§‹å…³å¡]
    â†“
åŠ è½½å…³å¡é…ç½®
    â†“
åˆå§‹åŒ–åœºæ™¯
    â†“
ç”Ÿæˆç©å®¶è§’è‰²
    â†“
[å…³å¡è¿›è¡Œä¸­]
    â”œâ”€â†’ ç”Ÿæˆæ•Œäººæ³¢æ¬¡
    â”œâ”€â†’ æ£€æµ‹èƒœåˆ©/å¤±è´¥æ¡ä»¶
    â””â”€â†’ æ›´æ–°UIæ˜¾ç¤º
    â†“
[å…³å¡ç»“æŸ]
    â†“
ç»“ç®—å¥–åŠ±
    â†“
ä¿å­˜è¿›åº¦
    â†“
è¿”å›ä¸»èœå•/ä¸‹ä¸€å…³å¡
```

---

## ä¸è”æœºæ¨¡å¼çš„åŒºåˆ«

### æ¶æ„å¯¹æ¯”

| ç»„ä»¶ | å•æœºæ¨¡å¼ | è”æœºæ¨¡å¼ |
|------|----------|----------|
| **Room** | æœ¬åœ°åˆ›å»º | æœåŠ¡å™¨åˆ›å»º |
| **å¸§åŒæ­¥** | æœ¬åœ°é©±åŠ¨ | æœåŠ¡å™¨æ¨é€ |
| **è¾“å…¥** | ç›´æ¥åº”ç”¨ | ä¸ŠæŠ¥æœåŠ¡å™¨ |
| **å¯¹æ‰‹** | AIæ§åˆ¶ | å…¶ä»–ç©å®¶ |
| **å»¶è¿Ÿ** | 0ms | ç½‘ç»œå»¶è¿Ÿ |
| **æš‚åœ** | âœ… æ”¯æŒ | âŒ ä¸æ”¯æŒ |
| **å­˜æ¡£** | æœ¬åœ°æ–‡ä»¶ | æœåŠ¡å™¨æ•°æ®åº“ |
| **è°ƒè¯•** | ç®€å• | å¤æ‚ |

### ä»£ç å¤ç”¨

**å…±äº«çš„é€»è¾‘å±‚ä»£ç ** (100%å¤ç”¨):
- âœ… Entity-Component-Capability æ¶æ„
- âœ… æˆ˜æ–—ç³»ç»Ÿ (æŠ€èƒ½ã€ä¼¤å®³ã€buff)
- âœ… ç‰©ç†ç³»ç»Ÿ (ç¢°æ’æ£€æµ‹)
- âœ… åŠ¨ä½œç³»ç»Ÿ (åŠ¨ä½œçŠ¶æ€æœº)
- âœ… å¸§åŒæ­¥é€»è¾‘ (FrameSyncManager)

**ä¸åŒçš„å®¢æˆ·ç«¯ä»£ç **:
- âŒ è¾“å…¥å¤„ç†æ–¹å¼
  - å•æœº: `InputManager` â†’ `Room`
  - è”æœº: `InputManager` â†’ `NetworkManager` â†’ `Server` â†’ `Room`
  
- âŒ å¸§é©±åŠ¨æ–¹å¼
  - å•æœº: `Unity Update()` é©±åŠ¨
  - è”æœº: æœåŠ¡å™¨å¸§æ¨é€é©±åŠ¨

- âŒ å¯¹æ‰‹æ¥æº
  - å•æœº: `AIController` ç”Ÿæˆè¾“å…¥
  - è”æœº: å…¶ä»–ç©å®¶çš„ç½‘ç»œè¾“å…¥

### åˆ‡æ¢é€»è¾‘

é€šè¿‡ `GameConfig.IsSinglePlayerMode` åŒºåˆ†ï¼š

```csharp
// åœ¨å¯åŠ¨æ¸¸æˆæ—¶
if (GameConfig.Instance.IsSinglePlayerMode)
{
    // å•æœºæ¨¡å¼
    GamePlayManager.Instance.StartSinglePlayerGame("GameScene");
}
else
{
    // è”æœºæ¨¡å¼
    NetworkManager.Instance.Connect(serverAddress);
    // ... åç»­ç™»å½•ã€åŒ¹é…ã€è¿›å…¥æˆ¿é—´æµç¨‹
}
```

---

## æŠ€æœ¯é™åˆ¶å’Œæ³¨æ„äº‹é¡¹

### ç¡®å®šæ€§è¦æ±‚

å³ä½¿æ˜¯å•æœºæ¨¡å¼ï¼Œä¹Ÿå¿…é¡»ä¿æŒé€»è¾‘çš„**ç¡®å®šæ€§**ï¼ŒåŸå› ï¼š

1. **å›æ”¾ç³»ç»Ÿ** - æ”¯æŒå½•åƒå›æ”¾
2. **è°ƒè¯•** - å¯é‡ç°bug
3. **ä»£ç ä¸€è‡´æ€§** - ä¸è”æœºæ¨¡å¼å…±äº«ä»£ç 

**å…³é”®åŸåˆ™**:
- âœ… ä½¿ç”¨ TrueSync (FP) è€Œé float
- âœ… é¿å… Random.Range()ï¼Œä½¿ç”¨ç¡®å®šæ€§éšæœº
- âœ… é¿å… Time.deltaTimeï¼Œä½¿ç”¨å›ºå®šæ—¶é—´æ­¥

### æ€§èƒ½ä¼˜åŒ–

å•æœºæ¨¡å¼æ— ç½‘ç»œå»¶è¿Ÿï¼Œä½†ä»éœ€æ³¨æ„ï¼š

- ä¿æŒ 60 FPS
- Entity æ•°é‡æ§åˆ¶ï¼ˆå»ºè®® < 100ï¼‰
- ç‰©ç†æŸ¥è¯¢ä¼˜åŒ–
- GC å‹åŠ›æ§åˆ¶

### è°ƒè¯•å»ºè®®

1. **Gizmoså¯è§†åŒ–** - å·²å®ç°ç¢°æ’ç›’å¯è§†åŒ–
2. **æ—¥å¿—åˆ†çº§** - ä½¿ç”¨ ASLogger çš„ä¸åŒçº§åˆ«
3. **å¸§å›æ”¾** - è®°å½•è¾“å…¥åºåˆ—ï¼Œæ”¯æŒé‡æ”¾
4. **æ€§èƒ½åˆ†æ** - Unity Profiler

---

## ä¸‹ä¸€æ­¥å¼€å‘è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„ âœ…
- âœ… GameConfig å•æœºæ¨¡å¼æ ‡è®°
- âœ… GameLauncher å¯åŠ¨æµç¨‹
- âœ… Room/World æœ¬åœ°åˆ›å»º
- âœ… Stage è¡¨ç°å±‚åŒæ­¥

### Phase 2: æ ¸å¿ƒç©æ³• âœ…
- âœ… ç©å®¶è§’è‰²åˆ›å»º
- âœ… ç§»åŠ¨å’Œæ“ä½œ
- âœ… æˆ˜æ–—ç³»ç»Ÿ
- âœ… æŠ€èƒ½æ•ˆæœ

### Phase 3: AIç³»ç»Ÿ ğŸš§
- ğŸš§ AIController æ¡†æ¶
- ğŸ“ åŸºç¡€AIå†³ç­–æ ‘
- ğŸ“ AIè¡Œä¸ºåº“
- ğŸ“ éš¾åº¦åˆ†çº§

### Phase 4: å…³å¡ç³»ç»Ÿ ğŸ“
- ğŸ“ å…³å¡é…ç½®è¡¨è®¾è®¡
- ğŸ“ å…³å¡åŠ è½½å™¨
- ğŸ“ æ•Œäººç”Ÿæˆå™¨
- ğŸ“ å…³å¡äº‹ä»¶ç³»ç»Ÿ

### Phase 5: å­˜æ¡£ç³»ç»Ÿ ğŸ“
- ğŸ“ å­˜æ¡£æ•°æ®ç»“æ„
- ğŸ“ åºåˆ—åŒ–/ååºåˆ—åŒ–
- ğŸ“ è‡ªåŠ¨ä¿å­˜æœºåˆ¶
- ğŸ“ å­˜æ¡£ç®¡ç†UI

---

## ç›¸å…³æ–‡æ¡£

- [å•æœºæ¨¡å¼å¼€å‘è¿›å±•](_status%20å¼€å‘è¿›å±•/Single-Player-Progress%20å•æœºæ¨¡å¼å¼€å‘è¿›å±•.md) - è¯¦ç»†å¼€å‘è®°å½•
- [è”æœºæ¨¡å¼](Network-Multiplayer%20è”æœºæ¨¡å¼.md) - å¯¹æ¯”å‚è€ƒ
- [æˆ˜æ–—ç³»ç»Ÿ](../02-CombatSystem%20æˆ˜æ–—ç³»ç»Ÿ/) - å…±äº«çš„æˆ˜æ–—é€»è¾‘
- [ECCæ¶æ„](../05-CoreArchitecture%20æ ¸å¿ƒæ¶æ„/ECC-System%20ECCç»“æ„è¯´æ˜.md) - é€»è¾‘å±‚æ¶æ„
- [å¸§åŒæ­¥]() - å¸§åŒæ­¥æœºåˆ¶ï¼ˆå¾…è¡¥å……ï¼‰

---

**æœ€åæ›´æ–°**: 2025-10-10  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ



