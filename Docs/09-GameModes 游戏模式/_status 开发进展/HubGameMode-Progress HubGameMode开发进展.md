# ğŸ  HubGameMode å¼€å‘è¿›å±•

**ç‰ˆæœ¬å†å²**: è®¾è®¡é˜¶æ®µ  
**æœ€åæ›´æ–°**: 2025-01-15

---

## ğŸ“Š æ€»ä½“è¿›åº¦

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆåº¦ | è¯´æ˜ |
|------|------|--------|------|
| Phase 0: æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡ | âœ… å®Œæˆ | 100% | å®Œæ•´æŠ€æœ¯è®¾è®¡æ–‡æ¡£ |
| Phase 1: åŸºç¡€æ¶æ„ | ğŸ“ è®¡åˆ’ä¸­ | 0% | GameModeã€æ•°æ®ç»“æ„ |
| Phase 2: åœºæ™¯å’ŒUI | ğŸ“ è®¡åˆ’ä¸­ | 0% | HubSceneã€HubView |
| Phase 3: é›†æˆä¸æµ‹è¯• | ğŸ“ è®¡åˆ’ä¸­ | 0% | å¾ªç¯æµ‹è¯• |
| Phase 4: åœºæ™¯åˆ‡æ¢ä¼˜åŒ– | ğŸ“ è®¡åˆ’ä¸­ | 0% | åŠ è½½è¿›åº¦ã€åŠ¨ç”» |

**æ€»ä½“å®Œæˆåº¦**: 10% (ä»…è®¾è®¡å®Œæˆ)

---

## ç‰ˆæœ¬å†å²

### 2025-01-15 - è®¾è®¡é˜¶æ®µå®Œæˆ

#### âœ… Phase 0: æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡

**é‡Œç¨‹ç¢‘**: HubGameMode å®Œæ•´æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡å®Œæˆï¼

##### 1. æ¶æ„è®¾è®¡ç¡®å®š âœ…

**æ ¸å¿ƒå†³ç­–**ï¼š
- âœ… ä½¿ç”¨ç‹¬ç«‹çš„ PlayerDataManager ç»Ÿä¸€ç®¡ç†ç©å®¶æ•°æ®
- âœ… åªæŒä¹…åŒ–åŸºç¡€è¿›åº¦æ•°æ®ï¼ˆLevelã€Expã€åŠ ç‚¹ç­‰ï¼‰ï¼Œä¸ä¿å­˜æ´¾ç”Ÿå±æ€§
- âœ… GameMode ä¸æŒæœ‰ HubView å¼•ç”¨ï¼Œé€šè¿‡äº‹ä»¶é€šä¿¡
- âœ… ç®€åŒ–çš„ GameModeStateï¼Œæ— å†…éƒ¨çŠ¶æ€
- âœ… æ¢ç´¢ç»“ç®—åŠŸèƒ½æš‚ä¸å®ç°ï¼ˆå…ˆè·‘é€šå¾ªç¯ï¼‰

**æ•°æ®ç®¡ç†æ–¹æ¡ˆ**ï¼š
```
PlayerDataManager (å…¨å±€å•ä¾‹)
    â†“ ç®¡ç†
PlayerProgressData (æŒä¹…åŒ–æ•°æ®)
    â”œâ”€ Level, Exp, RoleId
    â”œâ”€ AvailableStatPoints
    â”œâ”€ AllocatedXxxPoints
    â””â”€ StarFragments
```

##### 2. æ¥å£è®¾è®¡ âœ…

**HubGameMode æ ¸å¿ƒæ¥å£**ï¼š
- `Initialize()` - åŸºç¡€åˆå§‹åŒ–
- `Update()` - æ— ç‰¹æ®Šé€»è¾‘ï¼ˆUI é©±åŠ¨ï¼‰
- `Shutdown()` - æ¸…ç†èµ„æº
- `StartExploration()` - åˆ‡æ¢åˆ°æ¢ç´¢æ¨¡å¼

**PlayerDataManager æ ¸å¿ƒæ¥å£**ï¼š
- `Initialize()` - åŠ è½½æ•°æ®
- `LoadProgressData()` - ä»æ–‡ä»¶åŠ è½½
- `SaveProgressData()` - ä¿å­˜åˆ°æ–‡ä»¶

##### 3. UI è®¾è®¡ âœ…

**HubView ç®€åŒ–è®¾è®¡**ï¼š
- å¼€å§‹æ¢ç´¢æŒ‰é’®ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
- èµ„æºæ˜¾ç¤ºï¼ˆæ˜Ÿèƒ½ç¢ç‰‡ï¼‰
- æ— å‡çº§é¢æ¿ï¼ˆæš‚ä¸å®ç°ï¼‰

**UI ä¸ GameMode è§£è€¦**ï¼š
- HubGameMode ä¸æŒæœ‰ HubView å¼•ç”¨
- é€šè¿‡äº‹ä»¶ `StartExplorationRequestEventData` é€šä¿¡
- UI é€šè¿‡ PlayerDataManager è·å–æ•°æ®

##### 4. åœºæ™¯åˆ‡æ¢è®¾è®¡ âœ…

**HubScene**ï¼š
- ç©ºåœºæ™¯å ä½
- ä»…åŒ…å« HubView UI
- é¢„ç•™å¡”é˜²å»ºé€ ç©ºé—´

##### 5. ä¸ç°æœ‰æ¨¡å¼çš„é›†æˆ âœ…

**æ¨¡å¼åˆ‡æ¢æµç¨‹**ï¼š
```
LoginGameMode â†’ HubGameMode â†’ SinglePlayerGameMode â†’ HubGameMode
```

**GameModeType æ‰©å±•**ï¼š
- æ·»åŠ  `Hub` æšä¸¾å€¼
- GameDirector æ”¯æŒ Hub æ¨¡å¼åˆ›å»ºå’Œåˆ‡æ¢

---

## ğŸ“‹ å¼€å‘ä»»åŠ¡æ¸…å•

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆ3-4å¤©ï¼‰

#### 1.1 æ ¸å¿ƒæ•°æ®ç»“æ„
- [ ] åˆ›å»º `PlayerProgressData.cs`
  - [ ] å®šä¹‰åŸºç¡€å­—æ®µï¼ˆLevel, Exp, RoleId ç­‰ï¼‰
  - [ ] å®šä¹‰åŠ ç‚¹å­—æ®µï¼ˆAllocatedXxxPointsï¼‰
  - [ ] å®šä¹‰èµ„æºå­—æ®µï¼ˆStarFragments, Resourcesï¼‰
  - [ ] æ·»åŠ  MemoryPack åºåˆ—åŒ–æ ‡è®°
- [ ] åˆ›å»º `PlayerDataManager.cs`
  - [ ] å®ç° Singleton æ¨¡å¼
  - [ ] å®ç° Initialize()
  - [ ] å®ç° LoadProgressData()
  - [ ] å®ç° SaveProgressData()
  - [ ] å®ç° CreateDefaultProgressData()

#### 1.2 GameMode å®ç°
- [ ] åˆ›å»º `HubGameMode.cs`
  - [ ] ç»§æ‰¿ BaseGameMode
  - [ ] å®ç° Initialize()
  - [ ] å®ç° Update()
  - [ ] å®ç° Shutdown()
  - [ ] å®ç° StartExploration()
  - [ ] è®¢é˜… StartExplorationRequestEventData äº‹ä»¶

#### 1.3 äº‹ä»¶å®šä¹‰
- [ ] åˆ›å»º `StartExplorationRequestEventData.cs`
  - [ ] ç»§æ‰¿ EventData
  - [ ] æ— é¢å¤–æ•°æ®ï¼ˆç©ºäº‹ä»¶ï¼‰
- [ ] åˆ›å»º `PlayerDataChangedEventData.cs`
  - [ ] ç»§æ‰¿ EventData
  - [ ] åŒ…å« PlayerProgressData å¼•ç”¨

#### 1.4 ç³»ç»Ÿé›†æˆ
- [ ] æ‰©å±• GameModeType æšä¸¾
  - [ ] æ·»åŠ  Hub å€¼
  - [ ] æ›´æ–° GameDirector.SwitchGameMode() switch è¯­å¥
- [ ] åˆ›å»º SaveSystemï¼ˆæˆ–ä½¿ç”¨ç°æœ‰å®ç°ï¼‰
  - [ ] LoadPlayerProgressData()
  - [ ] SavePlayerProgressData()
  - [ ] ä½¿ç”¨ MemoryPack åºåˆ—åŒ–

#### 1.5 åˆå§‹åŒ–é›†æˆ
- [ ] GameDirector.Initialize() ä¸­åˆå§‹åŒ– PlayerDataManager
  - [ ] åœ¨ InitializeManagers() ä¸­è°ƒç”¨ PlayerDataManager.Initialize()

---

### Phase 2: åœºæ™¯å’ŒUIï¼ˆ2-3å¤©ï¼‰

#### 2.1 åœºæ™¯åˆ›å»º
- [ ] åˆ›å»º HubScene Unity åœºæ™¯
  - [ ] ç©ºåœºæ™¯ï¼Œè®¾ç½®åŸºç¡€ç¯å…‰
  - [ ] æ·»åŠ  Canvasï¼ˆUI å®¹å™¨ï¼‰
  - [ ] åœºæ™¯åç§°ï¼šHubScene

#### 2.2 HubView UI
- [ ] åˆ›å»º HubView.cs è„šæœ¬
  - [ ] ç»§æ‰¿ UIRefs
  - [ ] å®šä¹‰ UI å¼•ç”¨ï¼ˆæŒ‰é’®ã€æ–‡æœ¬ï¼‰
  - [ ] å®ç° OnInitialize()
  - [ ] è®¢é˜… PlayerDataChangedEventData
  - [ ] è®¢é˜…æŒ‰é’®ç‚¹å‡»äº‹ä»¶
- [ ] åˆ›å»º HubView Prefab
  - [ ] è®¾è®¡åŸºç¡€å¸ƒå±€
  - [ ] æ·»åŠ å¼€å§‹æ¢ç´¢æŒ‰é’®
  - [ ] æ·»åŠ èµ„æºæ˜¾ç¤ºæ–‡æœ¬
  - [ ] ç»‘å®š UI ç»„ä»¶å¼•ç”¨
  - [ ] ç”Ÿæˆä»£ç å¼•ç”¨ï¼ˆUIToolï¼‰

#### 2.3 UI åŠŸèƒ½
- [ ] å¼€å§‹æ¢ç´¢æŒ‰é’®
  - [ ] ç‚¹å‡»è§¦å‘ StartExplorationRequestEventData
- [ ] èµ„æºæ˜¾ç¤º
  - [ ] ç›‘å¬ PlayerDataChangedEventData
  - [ ] æ›´æ–°æ˜Ÿèƒ½ç¢ç‰‡æ˜¾ç¤º
- [ ] ç©å®¶ç­‰çº§æ˜¾ç¤º
  - [ ] ç›‘å¬æ•°æ®å˜åŒ–
  - [ ] æ›´æ–°ç­‰çº§æ–‡æœ¬

---

### Phase 3: é›†æˆä¸æµ‹è¯•ï¼ˆ2-3å¤©ï¼‰

#### 3.1 GameMode é›†æˆ
- [ ] LoginGameMode é›†æˆ
  - [ ] å•æœºæ¸¸æˆæŒ‰é’®åˆ‡æ¢åˆ° HubGameMode
  - [ ] æµ‹è¯•æ¨¡å¼åˆ‡æ¢æµç¨‹
- [ ] SinglePlayerGameMode é›†æˆ
  - [ ] æ¢ç´¢ç»“æŸåˆ‡æ¢åˆ° HubGameMode
  - [ ] ç§»é™¤/æ³¨é‡Šæ‰æ—§çš„è·³è½¬é€»è¾‘
- [ ] HubGameMode é›†æˆ
  - [ ] Initialize() æ˜¾ç¤º HubView
  - [ ] Shutdown() æ¸…ç† UI
  - [ ] StartExploration() åˆ‡æ¢åˆ°æ¢ç´¢

#### 3.2 åœºæ™¯åˆ‡æ¢é›†æˆ
- [ ] HubGameMode åœºæ™¯åˆ‡æ¢
  - [ ] è¿›å…¥ Hub æ—¶åŠ è½½ HubScene
  - [ ] åœºæ™¯åŠ è½½å®Œæˆåæ˜¾ç¤º UI
- [ ] SinglePlayerGameMode åœºæ™¯åˆ‡æ¢
  - [ ] ç¡®ä¿ DungeonsGame åœºæ™¯æ­£ç¡®åˆ‡æ¢
  - [ ] åœºæ™¯åŠ è½½å®Œæˆååˆ›å»ºç©å®¶

#### 3.3 æ•°æ®æµæµ‹è¯•
- [ ] PlayerDataManager æµ‹è¯•
  - [ ] é¦–æ¬¡è¿è¡Œåˆ›å»ºé»˜è®¤æ•°æ®
  - [ ] æ•°æ®ä¿å­˜å’ŒåŠ è½½
  - [ ] æ•°æ®ä¸€è‡´æ€§éªŒè¯
- [ ] æ¨¡å¼åˆ‡æ¢æ•°æ®æµ‹è¯•
  - [ ] Hub â†’ æ¢ç´¢ï¼Œæ•°æ®æ­£ç¡®ä¼ é€’
  - [ ] æ¢ç´¢ â†’ Hubï¼Œæ•°æ®æ­£ç¡®ä¿å­˜
  - [ ] å¤šæ¬¡å¾ªç¯ï¼Œæ•°æ®ä¸ä¸¢å¤±

#### 3.4 å®Œæ•´å¾ªç¯æµ‹è¯•
- [ ] Login â†’ Hub â†’ æ¢ç´¢ â†’ Hub å¾ªç¯
  - [ ] æ¨¡å¼åˆ‡æ¢æ­£ç¡®
  - [ ] åœºæ™¯åˆ‡æ¢æ­£ç¡®
  - [ ] UI æ˜¾ç¤ºæ­£ç¡®
  - [ ] æ•°æ®ä¿å­˜æ­£ç¡®

---

### Phase 4: åœºæ™¯åˆ‡æ¢ä¼˜åŒ–ï¼ˆ1-2å¤©ï¼‰

#### 4.1 åŠ è½½æç¤º
- [ ] åˆ›å»º LoadingUI
  - [ ] åŠ è½½è¿›åº¦æ¡
  - [ ] åŠ è½½æç¤ºæ–‡æœ¬
- [ ] åœºæ™¯åŠ è½½æœŸé—´æ˜¾ç¤º
  - [ ] HubGameMode åˆ‡æ¢æ—¶æ˜¾ç¤º
  - [ ] SinglePlayerGameMode åˆ‡æ¢æ—¶æ˜¾ç¤º

#### 4.2 åˆ‡æ¢ä¼˜åŒ–
- [ ] åœºæ™¯åˆ‡æ¢åŠ¨ç”»
  - [ ] æ·¡å…¥æ·¡å‡ºæ•ˆæœ
  - [ ] é»‘å±è¿‡æ¸¡
- [ ] æ€§èƒ½ä¼˜åŒ–
  - [ ] å¼‚æ­¥åŠ è½½ä¼˜åŒ–
  - [ ] UI æ˜¾ç¤ºå»¶è¿Ÿä¼˜åŒ–

---

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### å·²ç¡®å®šçš„è®¾è®¡å†³ç­–

#### 1. æ•°æ®ç®¡ç†æ–¹å¼
- âœ… ç‹¬ç«‹çš„ PlayerDataManager ç®¡ç†ç©å®¶è¿›åº¦
- âœ… åªæŒä¹…åŒ– Levelã€Expã€åŠ ç‚¹ã€èµ„æº
- âœ… ä¸ä¿å­˜æ´¾ç”Ÿå±æ€§ï¼ˆMaxHPã€ATK ç­‰è®¡ç®—å€¼ï¼‰

#### 2. UI æ¶æ„
- âœ… GameMode ä¸æŒæœ‰ HubView å¼•ç”¨
- âœ… é€šè¿‡äº‹ä»¶ç³»ç»Ÿé€šä¿¡
- âœ… UI é€šè¿‡ PlayerDataManager è·å–æ•°æ®

#### 3. æ¥å£è®¾è®¡
- âœ… HubGameMode å®ç°æœ€ç®€æ¥å£
- âœ… æ— å†…éƒ¨çŠ¶æ€æœº
- âœ… é€šè¿‡ BaseGameMode é€šç”¨åŠŸèƒ½

#### 4. åœºæ™¯ç®¡ç†
- âœ… HubScene ç©ºåœºæ™¯å ä½
- âœ… ä½¿ç”¨ SceneManager.LoadSceneAsync()
- âœ… åœºæ™¯åŠ è½½å®Œæˆååˆå§‹åŒ– UI

### å¾…è®¨è®ºçš„æŠ€æœ¯é—®é¢˜

#### 1. IGameMode æ¥å£é‡æ„
**é—®é¢˜**ï¼šæ˜¯å¦å°† Initialize() å’Œ StartGame() åˆå¹¶ä¸º OnModeEnter()

**å½±å“**ï¼š
- å½±å“æ‰€æœ‰ç°æœ‰ GameMode
- éœ€è¦ç»Ÿä¸€é‡æ„

**æ¨è**ï¼š
- æš‚æ—¶ä¿æŒä¸å˜ï¼Œç¡®ä¿ HubGameMode å…ˆå®ç°
- æ¥å£é‡æ„ä½œä¸ºç‹¬ç«‹ä»»åŠ¡

#### 2. SaveSystem å®ç°ä½ç½®
**é—®é¢˜**ï¼šSaveSystem æ”¾åœ¨å“ªä¸ªå‘½åç©ºé—´å’Œæ–‡ä»¶

**é€‰é¡¹**ï¼š
- A. ç‹¬ç«‹çš„ SaveSystem é™æ€ç±»
- B. æ”¾åœ¨ PlayerDataManager ä¸­
- C. æ”¾åœ¨ CommonBase

**æ¨è**ï¼š
- é€‰é¡¹ Aï¼Œä¿æŒèŒè´£æ¸…æ™°

#### 3. PlayerDataManager åˆå§‹åŒ–æ—¶æœº
**é—®é¢˜**ï¼šä½•æ—¶åˆå§‹åŒ– PlayerDataManager

**é€‰é¡¹**ï¼š
- A. GameDirector.Initialize() æ—¶
- B. ç¬¬ä¸€æ¬¡ä½¿ç”¨ HubGameMode æ—¶

**æ¨è**ï¼š
- é€‰é¡¹ Aï¼Œç¡®ä¿æ•°æ®éšæ—¶å¯ç”¨

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### Phase 1 éªŒæ”¶
- [ ] HubGameMode.cs ç¼–è¯‘é€šè¿‡
- [ ] PlayerDataManager.cs ç¼–è¯‘é€šè¿‡
- [ ] æ‰€æœ‰äº‹ä»¶å®šä¹‰ç¼–è¯‘é€šè¿‡
- [ ] GameDirector æ”¯æŒ Hub æ¨¡å¼åˆ‡æ¢
- [ ] å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆå¦‚æœ‰ï¼‰

### Phase 2 éªŒæ”¶
- [ ] HubScene åœºæ™¯å¯åŠ è½½
- [ ] HubView UI æ­£ç¡®æ˜¾ç¤º
- [ ] å¼€å§‹æ¢ç´¢æŒ‰é’®ç‚¹å‡»æœ‰å“åº”
- [ ] èµ„æºæ•°æ®æ­£ç¡®æ˜¾ç¤º

### Phase 3 éªŒæ”¶
- [ ] Login â†’ Hub åˆ‡æ¢æ­£å¸¸
- [ ] Hub â†’ æ¢ç´¢ åˆ‡æ¢æ­£å¸¸
- [ ] æ¢ç´¢ â†’ Hub è¿”å›æ­£å¸¸
- [ ] ç©å®¶æ•°æ®ä¿å­˜å’ŒåŠ è½½æ­£å¸¸
- [ ] å¤šæ¬¡å¾ªç¯æ— å¼‚å¸¸

### Phase 4 éªŒæ”¶
- [ ] åœºæ™¯åˆ‡æ¢æœ‰åŠ è½½æç¤º
- [ ] åŠ è½½è¿‡ç¨‹æµç•…æ— å¡é¡¿
- [ ] åˆ‡æ¢åŠ¨ç”»æ•ˆæœè‡ªç„¶
- [ ] æ€§èƒ½è¾¾æ ‡ï¼ˆå¯åŠ¨ < 5ç§’ï¼‰

---

## ğŸ“ å·²çŸ¥é™åˆ¶

### å½“å‰ç‰ˆæœ¬é™åˆ¶
1. **æ— ç»“ç®—åŠŸèƒ½**ï¼šæ¢ç´¢å®Œæˆåæ— å¥–åŠ±è®¡ç®—
2. **æ— å…»æˆåŠŸèƒ½**ï¼šæ— å‡çº§ã€åŠ ç‚¹åŠŸèƒ½
3. **æ— å¡”é˜²**ï¼šæ— å¤œæ½®å¡”é˜²å…¥å£
4. **UI ç®€åŒ–**ï¼šç•Œé¢è¾ƒä¸ºåŸºç¡€

### åç»­è®¡åˆ’
- v0.2: æ·»åŠ æ¢ç´¢ç»“ç®—åŠŸèƒ½
- v0.3: æ·»åŠ å¡”é˜²å¤œæ½®å…¥å£
- v0.4: æ·»åŠ è§’è‰²å…»æˆå’ŒåŠ ç‚¹
- v0.5: æ·»åŠ åŸºåœ°å»ºé€ ç³»ç»Ÿ

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [HubGameMode æŠ€æœ¯è®¾è®¡](../HubGameMode-Technical-Design%20HubGameModeæŠ€æœ¯è®¾è®¡.md)
- [å•æœºæ¨¡å¼è®¾è®¡](../Single-Player%20å•æœºæ¨¡å¼.md)
- [æ•°å€¼ç³»ç»Ÿè®¾è®¡](../../02-CombatSystem%20æˆ˜æ–—ç³»ç»Ÿ/æ•°å€¼ç³»ç»Ÿ/Stats-System%20æ•°å€¼ç³»ç»Ÿ.md)
- [å•æœºé—­ç¯ v0.1 è®¡åˆ’](../../é¡¹ç›®ç®¡ç†/SinglePlayer-Loop/SinglePlayer-Loop-v0.1.md)

---

**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025-01-15
