# å¸§åˆ»åº¦åŒæ­¥æ»šåŠ¨ä¿®å¤ (æœ€ç»ˆç‰ˆ)

> ğŸ“… **æ—¥æœŸ**: 2025-10-11  
> ğŸ¯ **ç›®æ ‡**: ä¿®å¤å¸§åˆ»åº¦ä¸éšè½¨é“æ»šåŠ¨çš„é—®é¢˜  
> âœ… **çŠ¶æ€**: å®Œæˆ

---

## ğŸ› **é—®é¢˜**

å¸§åˆ»åº¦è™½ç„¶æ·»åŠ äº†ScrollViewï¼Œä½†**ä¸ä¼šè·Ÿéšè½¨é“åŒºåŸŸæ»šåŠ¨**ï¼š
- âŒ è½¨é“åŒºåŸŸæ¨ªå‘æ»šåŠ¨æ—¶ï¼Œå¸§åˆ»åº¦ä¿æŒé™æ­¢
- âŒ ä¸¤è€…æ²¡æœ‰æ­£ç¡®åŒæ­¥

---

## ğŸ” **æ ¹æœ¬åŸå› **

**ScrollViewé¡ºåºé—®é¢˜**ï¼š
1. å¸§åˆ»åº¦çš„ScrollViewå…ˆç»˜åˆ¶ï¼ˆæ²¡æœ‰æ»šåŠ¨æ¡ï¼Œç”¨æˆ·æ— æ³•æ“ä½œï¼‰
2. è½¨é“çš„ScrollViewåç»˜åˆ¶ï¼ˆæœ‰æ»šåŠ¨æ¡ï¼Œç”¨æˆ·å¯ä»¥æ“ä½œï¼‰
3. è™½ç„¶å…±äº« `_scrollPosition`ï¼Œä½†å¸§åˆ»åº¦çš„ScrollViewä¸å“åº”ç”¨æˆ·æ“ä½œ
4. ç»“æœï¼šè½¨é“æ»šåŠ¨æ—¶æ›´æ–°äº† `_scrollPosition`ï¼Œä½†å¸§åˆ»åº¦çš„ScrollViewå·²ç»ç»˜åˆ¶å®Œæˆ

---

## ğŸ”§ **è§£å†³æ–¹æ¡ˆ**

**æ”¹ç”¨ GUI.BeginGroup + æ‰‹åŠ¨åç§»**ï¼š

```csharp
// === ä¿®å¤å‰ï¼ˆä½¿ç”¨ScrollViewï¼‰âŒ ===
public void DrawFrameScale(Rect rect, int totalFrames, int currentFrame)
{
    EditorGUI.DrawRect(rect, COLOR_FRAME_SCALE_BG);
    
    float contentWidth = Mathf.Max(...);
    Rect viewRect = new Rect(0, 0, contentWidth, rect.height);
    
    // ç‹¬ç«‹çš„ScrollView - ä¸å“åº”ç”¨æˆ·æ“ä½œï¼
    _scrollPosition = GUI.BeginScrollView(rect, _scrollPosition, viewRect, ...);
    
    DrawFrameLines(viewRect, totalFrames);
    DrawFrameNumbers(viewRect, totalFrames);
    
    GUI.EndScrollView();
}

// === ä¿®å¤åï¼ˆä½¿ç”¨Group + æ‰‹åŠ¨åç§»ï¼‰âœ… ===
public void DrawFrameScale(Rect rect, int totalFrames, int currentFrame)
{
    EditorGUI.DrawRect(rect, COLOR_FRAME_SCALE_BG);
    
    // ç»˜åˆ¶å·¦ä¾§æ ‡é¢˜èƒŒæ™¯
    float trackHeaderWidth = _layoutCalculator.GetTrackHeaderWidth();
    Rect headerBgRect = new Rect(rect.x, rect.y, trackHeaderWidth, rect.height);
    EditorGUI.DrawRect(headerBgRect, COLOR_TRACK_HEADER);
    DrawVerticalLine(...);
    
    // ä½¿ç”¨Groupè£å‰ªç»˜åˆ¶èŒƒå›´
    Rect contentRect = new Rect(
        rect.x + trackHeaderWidth,
        rect.y,
        rect.width - trackHeaderWidth,
        rect.height
    );
    GUI.BeginGroup(contentRect);
    
    // åº”ç”¨æ»šåŠ¨åç§»ï¼ˆä»è½¨é“åŒºåŸŸè¯»å– _scrollPositionï¼‰
    Rect offsetRect = new Rect(
        -_scrollPosition.x,  // â† å…³é”®ï¼šæ‰‹åŠ¨åº”ç”¨æ¨ªå‘æ»šåŠ¨åç§»
        0,
        contentRect.width + _scrollPosition.x,
        contentRect.height
    );
    
    DrawFrameLines(offsetRect, totalFrames);
    DrawFrameNumbers(offsetRect, totalFrames);
    
    GUI.EndGroup();
}
```

---

## ğŸ“Š **å·¥ä½œåŸç†**

### **æ»šåŠ¨åŒæ­¥æµç¨‹**

```
1. ç”¨æˆ·æ“ä½œè½¨é“åŒºåŸŸçš„æ»šåŠ¨æ¡
   â†“
2. è½¨é“åŒºåŸŸçš„ScrollViewæ›´æ–° _scrollPosition.x
   â†“
3. ä¸‹ä¸€å¸§ç»˜åˆ¶æ—¶ï¼š
   - å¸§åˆ»åº¦è¯»å– _scrollPosition.x
   - åˆ›å»º offsetRect.x = -_scrollPosition.x
   - æ•´ä¸ªåˆ»åº¦å†…å®¹å‘å·¦åç§»
   â†“
4. è§†è§‰æ•ˆæœï¼šå¸§åˆ»åº¦å’Œè½¨é“åŒæ­¥æ»šåŠ¨ âœ…
```

### **GUI.BeginGroup vs GUI.BeginScrollView**

**GUI.BeginScrollView**ï¼š
- âœ… è‡ªåŠ¨å¤„ç†æ»šåŠ¨æ¡
- âœ… è‡ªåŠ¨è£å‰ªå†…å®¹
- âŒ éœ€è¦ç”¨æˆ·ä¸å…¶äº¤äº’æ‰ä¼šæ›´æ–°æ»šåŠ¨ä½ç½®

**GUI.BeginGroup + æ‰‹åŠ¨åç§»**ï¼š
- âœ… è‡ªåŠ¨è£å‰ªå†…å®¹
- âœ… å¯ä»¥æ‰‹åŠ¨æ§åˆ¶åç§»é‡
- âœ… é€‚åˆ"åªè¯»"çš„æ»šåŠ¨åŒºåŸŸï¼ˆå¦‚å¸§åˆ»åº¦ï¼‰
- âŒ éœ€è¦æ‰‹åŠ¨è®¡ç®—åç§»

---

## ğŸ“ **ä¿®æ”¹æ–‡ä»¶æ¸…å•**

1. âœ… `Timeline/TimelineRenderer.cs`
   - ç§»é™¤å¸§åˆ»åº¦çš„ç‹¬ç«‹ScrollView
   - æ”¹ç”¨ `GUI.BeginGroup` + æ‰‹åŠ¨åç§»
   - ä¿®å¤ `DrawFrameLines` å’Œ `DrawFrameNumbers` çš„åæ ‡ç³»

---

## âœ… **ç¼–è¯‘ç»“æœ**

```bash
âœ… ç¼–è¯‘æˆåŠŸ - 0 errors
âœ… å¸§åˆ»åº¦ä½¿ç”¨Group + æ‰‹åŠ¨åç§»
âœ… å¸§åˆ»åº¦è¯»å–è½¨é“çš„æ»šåŠ¨ä½ç½®
âœ… åŒæ­¥æ»šåŠ¨å®ç°
```

---

## ğŸ® **æœ€ç»ˆæ•ˆæœ**

```
ç”¨æˆ·æ“ä½œï¼šæ¨ªå‘æ‹–åŠ¨è½¨é“åŒºåŸŸçš„æ»šåŠ¨æ¡
  â†“
å¸§åˆ»åº¦ï¼š[0]  [5]  [10] [15] [20] [25] [30]  â† è·Ÿéšæ»šåŠ¨ âœ…
  â†“
è½¨é“åŒºåŸŸï¼šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â† æ»šåŠ¨ âœ…
```

**å®Œç¾åŒæ­¥ï¼** ğŸŠ

---

**æ‰€æœ‰é—®é¢˜å·²è§£å†³ï¼š**
- âœ… Durationè™šçº¿æ˜¾ç¤º
- âœ… è½¨é“åŒºåŸŸå¡«æ»¡
- âœ… å¸§åˆ»åº¦å¡«æ»¡
- âœ… å¸§åˆ»åº¦å’Œè½¨é“åŒæ­¥æ»šåŠ¨ â† æœ¬æ¬¡ä¿®å¤
- âœ… çª—å£æ‹‰ä¼¸è‡ªåŠ¨è°ƒæ•´

