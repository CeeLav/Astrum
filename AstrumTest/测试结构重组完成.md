# æµ‹è¯•ç»“æ„é‡ç»„å®ŒæˆæŠ¥å‘Š

> ğŸ“… å®Œæˆæ—¶é—´: 2025-10-11  
> ğŸ¯ ç›®æ ‡: æŒ‰éƒ¨ç½²å•å…ƒå’Œæµ‹è¯•å±‚çº§é‡æ–°ç»„ç»‡æµ‹è¯•æ¡†æ¶

---

## âœ… å®Œæˆå†…å®¹

### 1. åˆ›å»ºäº†æ–°çš„æµ‹è¯•é¡¹ç›®ç»“æ„

```plaintext
AstrumTest/
â”œâ”€â”€ AstrumTest.Shared/          âœ… å…±äº«é€»è¾‘æµ‹è¯•
â”‚   â”œâ”€â”€ Unit/                   âœ… å•å…ƒæµ‹è¯• + ç»„ä»¶æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ Physics/           âœ… ç‰©ç†ç³»ç»Ÿæµ‹è¯•ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ Serialization/     âœ… åºåˆ—åŒ–æµ‹è¯•ï¼ˆ1ä¸ªæ–‡ä»¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ Skill/             ğŸ“ æŠ€èƒ½ç³»ç»Ÿï¼ˆç©ºï¼Œå¾…æ‰©å±•ï¼‰
â”‚   â”‚   â”œâ”€â”€ Config/            ğŸ“ é…ç½®ç³»ç»Ÿï¼ˆç©ºï¼Œå¾…æ‰©å±•ï¼‰
â”‚   â”‚   â”œâ”€â”€ ECS/               ğŸ“ ECSç³»ç»Ÿï¼ˆç©ºï¼Œå¾…æ‰©å±•ï¼‰
â”‚   â”‚   â””â”€â”€ Network/           ğŸ“ ç½‘ç»œåŸºç¡€ï¼ˆç©ºï¼Œå¾…æ‰©å±•ï¼‰
â”‚   â”œâ”€â”€ Integration/           ğŸ“ é›†æˆæµ‹è¯•ï¼ˆç©ºï¼Œç•™ç»™æœªæ¥ï¼‰
â”‚   â””â”€â”€ Fixtures/              âœ… æµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆ2ä¸ªæ–‡ä»¶ï¼‰
â”‚
â”œâ”€â”€ AstrumTest.Client/          âœ… å®¢æˆ·ç«¯æµ‹è¯•ï¼ˆå·²åˆ›å»ºç»“æ„ï¼‰
â”œâ”€â”€ AstrumTest.Server/          âœ… æœåŠ¡å™¨æµ‹è¯•ï¼ˆå·²åˆ›å»ºç»“æ„ï¼‰
â””â”€â”€ AstrumTest.E2E/            âœ… ç«¯åˆ°ç«¯æµ‹è¯•ï¼ˆå·²åˆ›å»ºç»“æ„ï¼‰
```

### 2. é…ç½®æ–‡ä»¶åˆ›å»ºå®Œæˆ

- âœ… `AstrumTest.Shared.csproj` - å¼•ç”¨å…±äº«ä»£ç 
- âœ… `AstrumTest.Client.csproj` - å¼•ç”¨å®¢æˆ·ç«¯ä»£ç  + Shared
- âœ… `AstrumTest.Server.csproj` - å¼•ç”¨æœåŠ¡å™¨ä»£ç  + Shared
- âœ… `AstrumTest.E2E.csproj` - å¼•ç”¨æ‰€æœ‰é¡¹ç›®

### 3. è¿ç§»äº†ç°æœ‰æµ‹è¯•æ–‡ä»¶

| æµ‹è¯•æ–‡ä»¶ | è¿ç§»åˆ° | çŠ¶æ€ |
|---------|--------|------|
| TypeConverterTests.cs | Shared/Unit/Physics/ | âœ… |
| HitManagerTests.cs | Shared/Unit/Physics/ | âœ… |
| ProtocolSerializationTests.cs | Shared/Unit/Serialization/ | âœ… |
| ConfigFixture.cs | Shared/Fixtures/ | âœ… |
| SharedTestScenario.cs | Shared/Fixtures/ | âœ… (æ–°åˆ›å»º) |

### 4. æ›´æ–°äº†æµ‹è¯• Trait æ ‡è®°

æ·»åŠ äº† `TestLevel` æ ‡è®°æ¥åŒºåˆ†æµ‹è¯•å±‚çº§ï¼š

```csharp
[Trait("TestLevel", "Unit")]      // çº¯å•å…ƒæµ‹è¯•
[Trait("TestLevel", "Component")] // ç»„ä»¶æµ‹è¯•
[Trait("TestLevel", "Integration")] // é›†æˆæµ‹è¯•ï¼ˆæœªæ¥ï¼‰
```

### 5. åˆ›å»ºäº†æ–‡æ¡£å’Œè„šæœ¬

- âœ… `README-NEW-STRUCTURE.md` - è¯¦ç»†çš„æ–°ç»“æ„è¯´æ˜
- âœ… `run-test-new.ps1` - æ–°çš„æµ‹è¯•è¿è¡Œè„šæœ¬
- âœ… æ›´æ–°äº† `README.md` æ·»åŠ è¿ç§»æç¤º

---

## ğŸ“Š æµ‹è¯•éªŒè¯ç»“æœ

### AstrumTest.Shared æµ‹è¯•è¿è¡ŒæˆåŠŸ

```
âœ… æµ‹è¯•æ€»æ•°: 41
âœ… é€šè¿‡æ•°: 35
â¸ï¸ è·³è¿‡æ•°: 6
â±ï¸ æ€»æ—¶é—´: 51ms
```

### æŒ‰æµ‹è¯•å±‚çº§åˆ†ç±»

**TestLevel=Unit (çº¯å•å…ƒæµ‹è¯•):**
```
æµ‹è¯•æ•°: 28
é€šè¿‡: 22
è·³è¿‡: 6
æ—¶é—´: 37ms
```

åŒ…å«ï¼š
- TypeConverterTests (20ä¸ªæµ‹è¯•)
- ProtocolSerializationTests (8ä¸ªæµ‹è¯•ï¼Œ6ä¸ªè·³è¿‡)

**TestLevel=Component (ç»„ä»¶æµ‹è¯•):**
```
æµ‹è¯•æ•°: 13
é€šè¿‡: 13
è·³è¿‡: 0
æ—¶é—´: 69ms
```

åŒ…å«ï¼š
- HitManagerTests (13ä¸ªæµ‹è¯•)

---

## ğŸ¯ æµ‹è¯•å±‚çº§å®šä¹‰

| å±‚çº§ | å®šä¹‰ | ä¾èµ– | é€Ÿåº¦ | å½“å‰æ•°é‡ |
|------|------|------|------|----------|
| **Unit** | çº¯å‡½æ•°ï¼Œæ— å¤–éƒ¨ä¾èµ– | æ—  | <10ms | 28ä¸ª |
| **Component** | å•ä¸ªæ¨¡å—+å°‘é‡ä¾èµ– | å•æ¨¡å— | 10-100ms | 13ä¸ª |
| **Integration** | å®Œæ•´æ¸¸æˆæµç¨‹ | å¤šæ¨¡å— | 100ms+ | 0ä¸ªï¼ˆå¾…åˆ›å»ºï¼‰ |

---

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### è¿è¡Œæ‰€æœ‰å…±äº«æµ‹è¯•

```bash
cd AstrumTest
dotnet test AstrumTest.Shared
```

### æŒ‰å±‚çº§è¿è¡Œ

```bash
# åªè¿è¡Œçº¯å•å…ƒæµ‹è¯•ï¼ˆæœ€å¿«ï¼‰
dotnet test AstrumTest.Shared --filter "TestLevel=Unit"

# åªè¿è¡Œç»„ä»¶æµ‹è¯•
dotnet test AstrumTest.Shared --filter "TestLevel=Component"

# è¿è¡Œå•å…ƒ + ç»„ä»¶ï¼ˆæ¨èæ—¥å¸¸ä½¿ç”¨ï¼‰
dotnet test AstrumTest.Shared --filter "TestLevel=Unit|TestLevel=Component"
```

### ä½¿ç”¨æ–°è„šæœ¬

```bash
.\run-test-new.ps1 -Project Shared
```

---

## ğŸ“ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆæœªå®æ–½ï¼‰

1. â­• åˆ›å»ºçœŸæ­£çš„é›†æˆæµ‹è¯•ç¤ºä¾‹
   - å®Œæ•´æˆ˜æ–—æµç¨‹æµ‹è¯•
   - æˆ¿é—´ç³»ç»Ÿæµç¨‹æµ‹è¯•
   - åŒ¹é…æµç¨‹æµ‹è¯•

2. â­• åˆ›å»ºé›†æˆæµ‹è¯•åŸºç¡€è®¾æ–½
   - GameFlowFixture
   - æ¨¡æ‹Ÿå®Œæ•´æ¸¸æˆç¯å¢ƒ

3. â­• æ‰©å±•å®¢æˆ·ç«¯/æœåŠ¡å™¨æµ‹è¯•é¡¹ç›®
   - æ·»åŠ å®¢æˆ·ç«¯ä¸“å±æµ‹è¯•
   - æ·»åŠ æœåŠ¡å™¨ä¸“å±æµ‹è¯•

### ä¸­æœŸ

4. â­• å®Œå–„æµ‹è¯•è¦†ç›–ç‡
   - æ·»åŠ æ›´å¤šå•å…ƒæµ‹è¯•
   - æ‰©å±•ç»„ä»¶æµ‹è¯•
   - å»ºç«‹è¦†ç›–ç‡ç›‘æ§

5. â­• æ€§èƒ½æµ‹è¯•
   - ä½¿ç”¨ BenchmarkDotNet
   - ç›‘æ§å…³é”®è·¯å¾„æ€§èƒ½

---

## âœ¨ ä¼˜åŠ¿æ€»ç»“

### æ–°ç»“æ„çš„ä¼˜ç‚¹

1. **èŒè´£æ¸…æ™°** - æŒ‰éƒ¨ç½²å•å…ƒï¼ˆShared/Client/Serverï¼‰åˆ’åˆ†
2. **å±‚çº§æ˜ç¡®** - é€šè¿‡ TestLevel åŒºåˆ†æµ‹è¯•å±‚çº§
3. **ç¼–è¯‘éš”ç¦»** - å„é¡¹ç›®ç‹¬ç«‹ç¼–è¯‘
4. **çµæ´»è¿‡æ»¤** - å¯æŒ‰éœ€è¿è¡Œä¸åŒå±‚çº§çš„æµ‹è¯•
5. **CI/CDå‹å¥½** - æ”¯æŒåˆ†é˜¶æ®µæµ‹è¯•ç­–ç•¥

### å¯¹æ¯”æ—§ç»“æ„

| ç»´åº¦ | æ—§ç»“æ„ | æ–°ç»“æ„ |
|------|--------|--------|
| **é¡¹ç›®æ•°é‡** | 1ä¸ª | 4ä¸ª |
| **èŒè´£åˆ’åˆ†** | æ··åˆ | æ¸…æ™° |
| **æµ‹è¯•å±‚çº§** | æ¨¡ç³Š | æ˜ç¡®ï¼ˆUnit/Component/Integrationï¼‰ |
| **è¿è¡Œé€Ÿåº¦** | å…¨éƒ¨ä¸€èµ·è·‘ | å¯æŒ‰éœ€é€‰æ‹© |
| **æ‰©å±•æ€§** | å—é™ | çµæ´» |

---

## ğŸ“– ç›¸å…³æ–‡æ¡£

- [README-NEW-STRUCTURE.md](./README-NEW-STRUCTURE.md) - æ–°ç»“æ„è¯¦ç»†è¯´æ˜
- [README.md](./README.md) - ä¸»READMEï¼ˆå·²æ›´æ–°è¿ç§»æç¤ºï¼‰
- [æ—§æµ‹è¯•ç›®å½•](./AstrumTest/AstrumTest/) - ä¿ç•™ä½œä¸ºå‘åå…¼å®¹

---

**æµ‹è¯•ç»“æ„é‡ç»„æˆåŠŸå®Œæˆï¼** âœ…

