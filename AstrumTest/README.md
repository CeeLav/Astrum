# AstrumTest - æµ‹è¯•é¡¹ç›®ä½¿ç”¨æŒ‡å—

## ğŸ‰ æ”¹è¿›å®Œæˆï¼

æµ‹è¯•é¡¹ç›®å·²ç»æ”¯æŒ**è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹**ï¼Œä¸å†éœ€è¦å…¨éƒ¨æµ‹è¯•éƒ½èƒ½ç¼–è¯‘æ‰èƒ½è¿è¡Œï¼

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹

```powershell
# Windows - ä½¿ç”¨ä¾¿æ·è„šæœ¬
cd d:\Develop\Projects\Astrum\AstrumTest
.\run-test.ps1 -TestName "GameNetworkMessage"

# æˆ–è€…ç›´æ¥ä½¿ç”¨ dotnet test
dotnet test AstrumTest/AstrumTest/AstrumTest.csproj --filter "Name~GameNetworkMessage"
```

### ç¦ç”¨ç¼–è¯‘å¤±è´¥çš„æµ‹è¯•

```powershell
# ä¸´æ—¶ç¦ç”¨è¿‡æ—¶çš„æµ‹è¯•ï¼ˆä¸å‚ä¸ç¼–è¯‘ï¼‰
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/OldTests.cs"

# ç°åœ¨å¯ä»¥è¿è¡Œå…¶ä»–æµ‹è¯•äº†ï¼
.\run-test.ps1 -List
```

### é‡æ–°å¯ç”¨æµ‹è¯•

```powershell
# ä¿®å¤åé‡æ–°å¯ç”¨
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/OldTests.cs" -Enable
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
AstrumTest/
â”œâ”€â”€ AstrumTest/
â”‚   â”œâ”€â”€ AstrumTest.csproj          # ä¸»æµ‹è¯•é¡¹ç›®
â”‚   â”œâ”€â”€ Common/
â”‚   â”‚   â””â”€â”€ ConfigFixture.cs       # æµ‹è¯•éš”ç¦»åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ ProtocolSerializationTests.cs  # ç½‘ç»œåè®®æµ‹è¯•
â”‚   â”œâ”€â”€ EntitySystemTests.cs       # å®ä½“ç³»ç»Ÿæµ‹è¯•ï¼ˆåŸ UnitTest1.csï¼‰
â”‚   â”œâ”€â”€ *.disabled                  # ä¸´æ—¶ç¦ç”¨çš„æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ *.bak                       # å¤‡ä»½çš„æµ‹è¯•æ–‡ä»¶
â”‚
â”œâ”€â”€ run-test.ps1                    # ä¾¿æ·è¿è¡Œè„šæœ¬ (Windows)
â”œâ”€â”€ run-test.sh                     # ä¾¿æ·è¿è¡Œè„šæœ¬ (Linux/Mac)
â”œâ”€â”€ ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1                # æµ‹è¯•æ–‡ä»¶ç®¡ç†è„šæœ¬
â”‚
â”œâ”€â”€ å¿«é€Ÿå¼€å§‹.md                      # å¿«é€Ÿä½¿ç”¨æŒ‡å—
â”œâ”€â”€ å¿«é€Ÿä½¿ç”¨æ¼”ç¤º.md                  # å®æˆ˜ç¤ºä¾‹
â”œâ”€â”€ è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹æŒ‡å—.md         # è¯¦ç»†çš„å‘½ä»¤å‚è€ƒ
â”œâ”€â”€ æµ‹è¯•é¡¹ç›®æ”¹è¿›æ–¹æ¡ˆ.md             # å®Œæ•´çš„æ”¹è¿›æ–¹æ¡ˆ
â””â”€â”€ æµ‹è¯•éš”ç¦»è§£å†³æ–¹æ¡ˆ.md             # é—®é¢˜åˆ†æå’Œè§£å†³æ–¹æ¡ˆ
```

---

## ğŸ“‹ å¸¸ç”¨å‘½ä»¤

### åˆ—å‡ºæµ‹è¯•

```powershell
# åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æµ‹è¯•
.\run-test.ps1 -List

# æˆ–
dotnet test --list-tests
```

### è¿è¡Œæµ‹è¯•

```powershell
# è¿è¡ŒåŒ…å«ç‰¹å®šåç§°çš„æµ‹è¯•
.\run-test.ps1 -TestName "Entity"

# è¿è¡Œå•å…ƒæµ‹è¯•
.\run-test.ps1 -Category Unit

# è¿è¡Œç½‘ç»œæ¨¡å—æµ‹è¯•
.\run-test.ps1 -Module Network

# è¯¦ç»†è¾“å‡º
.\run-test.ps1 -TestName "SerializeDeserialize" -Verbose
```

### ç®¡ç†æµ‹è¯•

```powershell
# ç¦ç”¨æµ‹è¯•ï¼ˆä¸´æ—¶ï¼‰
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/SomeTests.cs"

# å¯ç”¨æµ‹è¯•
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/SomeTests.cs" -Enable
```

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: å¼€å‘æ–°åŠŸèƒ½ï¼Œåªæµ‹è¯•ç›¸å…³æ¨¡å—

```powershell
# å¼€å‘ç‰©ç†åŠŸèƒ½æ—¶
.\run-test.ps1 -Module Physics

# å¼€å‘ç½‘ç»œåŠŸèƒ½æ—¶
.\run-test.ps1 -Module Network
```

### åœºæ™¯ 2: æŸä¸ªæµ‹è¯•ç¼–è¯‘å¤±è´¥ï¼Œä¸å½±å“å…¶ä»–æµ‹è¯•

```powershell
# 1. ç¦ç”¨ç¼–è¯‘å¤±è´¥çš„æµ‹è¯•
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/BrokenTests.cs"

# 2. ç»§ç»­å¼€å‘å’Œæµ‹è¯•å…¶ä»–åŠŸèƒ½
.\run-test.ps1 -Module Physics

# 3. ç¨åä¿®å¤å¹¶é‡æ–°å¯ç”¨
.\ä¸´æ—¶ç¦ç”¨æµ‹è¯•.ps1 -TestFile "AstrumTest/BrokenTests.cs" -Enable
```

### åœºæ™¯ 3: è°ƒè¯•å•ä¸ªæµ‹è¯•

```powershell
# è¿è¡Œå•ä¸ªæµ‹è¯•ï¼Œè¯¦ç»†è¾“å‡º
.\run-test.ps1 -TestName "Test_FP_To_Fix64_Basic" -Verbose
```

### åœºæ™¯ 4: æäº¤ä»£ç å‰å¿«é€ŸéªŒè¯

```powershell
# åªè¿è¡Œå•å…ƒæµ‹è¯•ï¼ˆå¿«é€Ÿï¼‰
.\run-test.ps1 -Category Unit

# å¦‚æœé€šè¿‡ï¼Œè¿è¡Œæ‰€æœ‰æµ‹è¯•
dotnet test
```

---

## ğŸ”§ å·²å®Œæˆçš„æ”¹è¿›

âœ… **ç»Ÿä¸€æµ‹è¯•æ¡†æ¶** - ä½¿ç”¨ Xunit  
âœ… **æ·»åŠ  Trait æ ‡è®°** - æ”¯æŒæŒ‰ç±»åˆ«/æ¨¡å—ç­›é€‰  
âœ… **åˆ›å»º ConfigFixture** - éš”ç¦»æµ‹è¯•çŠ¶æ€  
âœ… **è½¬æ¢ NUnit æµ‹è¯•** - ä» NUnit è¿ç§»åˆ° Xunit  
âœ… **ä¾¿æ·è¿è¡Œè„šæœ¬** - ä¸€è¡Œå‘½ä»¤è¿è¡Œæµ‹è¯•  
âœ… **æµ‹è¯•ç®¡ç†è„šæœ¬** - æ–¹ä¾¿ç¦ç”¨/å¯ç”¨æµ‹è¯•  

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

- **[å¿«é€Ÿå¼€å§‹.md](./å¿«é€Ÿå¼€å§‹.md)** - æ”¹è¿›åçš„å¿«é€Ÿä½¿ç”¨æŒ‡å—
- **[å¿«é€Ÿä½¿ç”¨æ¼”ç¤º.md](./å¿«é€Ÿä½¿ç”¨æ¼”ç¤º.md)** - å®æˆ˜å‘½ä»¤ç¤ºä¾‹
- **[è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹æŒ‡å—.md](./è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹æŒ‡å—.md)** - è¯¦ç»†çš„è¿‡æ»¤å™¨è¯­æ³•
- **[æµ‹è¯•é¡¹ç›®æ”¹è¿›æ–¹æ¡ˆ.md](./æµ‹è¯•é¡¹ç›®æ”¹è¿›æ–¹æ¡ˆ.md)** - å®Œæ•´çš„æ”¹è¿›æ–¹æ¡ˆ
- **[æµ‹è¯•éš”ç¦»è§£å†³æ–¹æ¡ˆ.md](./æµ‹è¯•éš”ç¦»è§£å†³æ–¹æ¡ˆ.md)** - é—®é¢˜åˆ†æå’Œå¤šç§è§£å†³æ–¹æ¡ˆ

---

## ğŸ› å·²çŸ¥é—®é¢˜

### å½“å‰å·²ç¦ç”¨çš„æµ‹è¯•æ–‡ä»¶

- `SkillSystemTests.cs.disabled` - ä½¿ç”¨è¿‡æ—¶çš„ API (SkillActions â†’ SkillActionIds)
- `HitManagerTests.cs.disabled` - Entity.Id â†’ Entity.UniqueId, ç¼ºå°‘ SetEntityId
- `TypeConverterTests.cs.disabled` - ToBepuMatrix â†’ ToBepuMatrix3x3, TSMatrix.M44 ä¸å­˜åœ¨
- `*.bak` æ–‡ä»¶ - ä¹‹å‰å¤‡ä»½çš„æµ‹è¯•

### å¾…ä¿®å¤çš„é—®é¢˜

1. **MemoryPack åºåˆ—åŒ–** - GameNetworkMessage åºåˆ—åŒ–å¤±è´¥
2. **è¿‡æ—¶çš„ API** - éƒ¨åˆ†æµ‹è¯•ä½¿ç”¨äº†æ—§ç‰ˆ API
3. **ç¼ºå°‘ä¾èµ–** - éƒ¨åˆ†æµ‹è¯•éœ€è¦é¢å¤–çš„é…ç½®æˆ–ä¾èµ–

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### çŸ­æœŸï¼ˆä»Šå¤©ï¼‰
- [x] ç¦ç”¨ç¼–è¯‘å¤±è´¥çš„æµ‹è¯•
- [x] éªŒè¯å•ä¸ªæµ‹è¯•å¯ä»¥è¿è¡Œ
- [ ] ä¿®å¤ ProtocolSerializationTests

### ä¸­æœŸï¼ˆ1å‘¨å†…ï¼‰
- [ ] ä¿®å¤æ‰€æœ‰ .disabled æµ‹è¯•
- [ ] æ·»åŠ æ›´å¤š Trait æ ‡è®°
- [ ] å®Œå–„æµ‹è¯•è¦†ç›–ç‡

### é•¿æœŸï¼ˆæŒç»­ï¼‰
- [ ] æ‹†åˆ†ä¸ºå¤šä¸ªæµ‹è¯•é¡¹ç›®ï¼ˆå¯é€‰ï¼‰
- [ ] å»ºç«‹ CI/CD æµæ°´çº¿
- [ ] å®šæœŸæ¸…ç†è¿‡æ—¶æµ‹è¯•

---

## âœ… æ•ˆæœæ€»ç»“

**æ”¹è¿›å‰**ï¼š
âŒ ä¸€ä¸ªæµ‹è¯•è¿‡æ—¶ â†’ æ•´ä¸ªé¡¹ç›®ç¼–è¯‘å¤±è´¥ â†’ æ— æ³•è¿è¡Œä»»ä½•æµ‹è¯•

**æ”¹è¿›å**ï¼š
âœ… ä¸€ä¸ªæµ‹è¯•è¿‡æ—¶ â†’ ä¸´æ—¶ç¦ç”¨è¿™ä¸ªæµ‹è¯• â†’ å…¶ä»–æµ‹è¯•æ­£å¸¸è¿è¡Œ  
âœ… å¯ä»¥è¿è¡Œå•ä¸ªæµ‹è¯•ç”¨ä¾‹  
âœ… å¯ä»¥æŒ‰æ¨¡å—/ç±»åˆ«ç­›é€‰  
âœ… å¼€å‘æ—¶ä¸å—å…¶ä»–æµ‹è¯•å½±å“  

---

**äº«å—é«˜æ•ˆã€éš”ç¦»çš„æµ‹è¯•ä½“éªŒï¼** ğŸš€

